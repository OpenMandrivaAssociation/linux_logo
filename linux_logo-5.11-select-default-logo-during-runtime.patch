--- linux_logo-5.11/linux_logo.c~	2013-07-11 06:37:19.345436587 +0200
+++ linux_logo-5.11/linux_logo.c	2013-07-11 06:37:24.353445111 +0200
@@ -16,9 +16,8 @@
 #include <stdio.h>
 #include <stdlib.h>   /* calloc() */
 #include <string.h>   /* strdup() */
+#include <sys/stat.h> /* stat() */
 #include <sys/time.h> /* time() */
-#include <sys/types.h>
-#include <sys/stat.h>
 #include <locale.h>
 
 #define ESCAPE "\033"
@@ -79,37 +78,8 @@ static void setup_default_logos() {
 
    struct logo_info *new_logo;
 
-   struct stat st;
-   typedef enum distro {
-       MOONDRAKE,
-       OPENMANDRIVA
-   } distro_t;
-
-   distro_t dist = MOONDRAKE;
-
-   if (!stat("/etc/os-release", &st)) {
-       char buf[BUFSIZ];
-       FILE *fp = fopen("/etc/os-release", "r");
-       fread(buf, sizeof(buf), 1, fp);
-       if (!ferror(fp)) {
-	   if (strcasestr(buf, "moondrake")) {
-	       dist = MOONDRAKE;
-	   } else if (strcasestr(buf, "openmandriva")) {
-	       dist = OPENMANDRIVA;
-	   }
-       }
-   }
-   switch (dist) {
-       default:
-       case MOONDRAKE: {
 #include "load_logos.h"
-	    }
-	    break;
-       case OPENMANDRIVA: {
-#include "load_logos_omv.h"
-	    }
-	    break;
-   }
+   
 }
 
 
@@ -1069,6 +1039,7 @@ int main(int argc,char **argv) {
     char temp_string[BUFSIZ],*temp_pointer;
     struct linux_logo_info_type settings;
     struct logo_info *custom_logo=NULL;
+    struct stat st;
 
 #if (USE_I18N==1)
        /* i18n */
@@ -1091,6 +1062,19 @@ int main(int argc,char **argv) {
        /* Setup all the logos */
     setup_default_logos();
 
+   if (!stat("/etc/os-release", &st)) {
+       char buf[BUFSIZ];
+       FILE *fp = fopen("/etc/os-release", "r");
+       fread(buf, sizeof(buf), 1, fp);
+       if (!ferror(fp)) {
+	   if (strcasestr(buf, "moondrake")) {
+	       logo_num = 2;
+	   } else if (strcasestr(buf, "openmandriva")) {
+	       logo_num = 3;
+	   }
+       }
+   }
+
        /* If user requested a list, list them and exit */
     if (want_list_logos) list_logos();
 
